<!doctype html>
<html lang="zh-Hant">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PLKP88TEVL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PLKP88TEVL');
</script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <link rel="icon" href="/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/icons/web-app-manifest-192x192.png" sizes="192x192" type="image/png">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#0b1020">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9198582877062732"
     crossorigin="anonymous"></script>
<!-- iOS å°ˆå±¬ï¼ˆSafari A2HSï¼‰-->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="æ—…è¡Œåœ°åœ–æ™‚å…‰æ©Ÿ">


  <title>æ—…è¡Œåœ°åœ–æ™‚å…‰æ©Ÿ</title>
  <style>
    :root{
      --bg:#0b1020; --card:#0f152b; --line:#223; --fg:#e9eefc; --muted:#9fb0d1; --accent:#3b82f6;
      --overlay: rgba(0,0,0,.5);
    }
    html,body{ height:100%; margin:0; background:var(--bg); color:var(--fg);
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC",sans-serif; }
    .wrap{ display:flex; flex-direction:column; min-height:100svh; }

    /* ===== Header & Nav ===== */
    header{ position:sticky; top:0; z-index:20; backdrop-filter:saturate(1.4) blur(8px);
      background:rgba(11,16,32,.75); border-bottom:1px solid var(--line); }
    nav{max-width:1100px;margin:0 auto;display:flex;align-items:center;justify-content:flex-start;padding:0 16px;}
    .logo{font-weight:700;font-size:18px;letter-spacing:.5px;padding:14px 0;margin-left:10px;}


    /* Desktop menu */
    .menu{ display:flex; gap:2px; }
    .menu button{ all:unset; cursor:pointer; padding:14px 20px; font-weight:600; font-size:15px; color:var(--muted);
      transition:.25s; border-bottom:2px solid transparent; }
    .menu button[aria-pressed="true"]{ color:var(--accent); border-color:var(--accent); }
    .menu button:hover{ color:var(--fg); }

    /* Mobile hamburger (hidden on desktop) */
    .hamburger{
      display:none; align-items:center; justify-content:center;
      width:40px; height:40px; margin-left:-8px; border-radius:8px; border:1px solid transparent;
      background:transparent; cursor:pointer;
    }
    .hamburger svg{ width:22px; height:22px;stroke:#fff;stroke-width:1; }
    .hamburger[aria-expanded="true"]{ background:rgba(255,255,255,.06); border-color:var(--line); }

    /* Drawer + Backdrop */
    .backdrop{
      position:fixed; inset:0; background:var(--overlay); opacity:0; pointer-events:none; transition:opacity .2s ease;
      z-index:18;
    }
    .drawer{
      position:fixed; inset:0 auto 0 0; width:min(80vw, 320px); max-width:90vw; background:var(--card);
      border-right:1px solid var(--line); transform:translateX(-100%); transition:transform .25s ease;
      z-index:19; display:flex; flex-direction:column;
    }
    .drawer-head{ display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--line); }
    .drawer-title{ font-weight:700; }
    .drawer-close{ all:unset; cursor:pointer; padding:8px; border-radius:8px; }
    .drawer-close:focus{ outline:2px solid var(--accent); outline-offset:2px; }
    .drawer-body{ padding:6px; }
    .drawer-body .drawer-btn{
      width:100%; text-align:left; display:block; border:1px solid var(--line); background:transparent;
      color:var(--fg); padding:14px 12px; margin:6px 6px; border-radius:10px; font-weight:600; cursor:pointer;font-size:18px;
    }
    .drawer-body .drawer-btn[aria-pressed="true"]{ border-color:var(--accent); color:var(--accent); }
    .drawer-body .drawer-btn:hover{ background:rgba(255,255,255,.04); }

    /* Open states (toggled by .open-drawer on body) */
    .open-drawer .backdrop{ opacity:1; pointer-events:auto; }
    .open-drawer .drawer{ transform:none; }

    /* Layout main/iframe/footer */
    main{ flex:1; display:flex; }
    .frame-wrap{ position:relative; flex:1; min-height:0; }
    
    iframe{position:absolute; inset:0; width:100%; height:100%;border:0;background:#fff;}

    .hidden{ display:none !important; }

    /* ===== Responsive ===== */
    @media (max-width: 900px){
      .menu{ display:none; }                /* hide desktop tabs on mobile */
      .hamburger{ display:flex; }           /* show hamburger */
      .logo{ padding:10px 0;font-size:20px; }              /* a bit tighter on mobile */
    }

    @media (prefers-reduced-motion: reduce){
      .backdrop, .drawer{ transition:none; }
    }
    .tab:focus,
.drawer-btn:focus,
.hamburger:focus,
.drawer-close:focus {
  outline: none;
  box-shadow: none;
}
  /* Desktopï¼šæŠŠé¸å–®æ•´æ’å¾€å³é  */
@media (min-width: 901px){
  .menu{ margin-left: auto; }  /* è®“ .logo åœ¨å·¦ã€.menu è²¼å³ */
}
/* CTA å°è† å›Šï¼šé è¨­éš±è—ï¼Œæ’­æ”¾æ™‚åŠ  .on é¡¯ç¤º */
.promo-rotator{
  display:none; align-items:center; gap:.5rem;
  margin-left:12px; margin-right:auto; /* è®“å®ƒå¡åœ¨ logo å’Œ menu ä¸­é–“ */
  padding:.28rem .64rem; border:1px solid var(--line, #e5e7eb);
  border-radius:999px; background:var(--card, #fff);
  color:var(--fg, #111); text-decoration:none;
  font-size:14px; line-height:1; white-space:nowrap;
  max-width:420px; overflow:hidden;
}
.promo-rotator.on{ display:flex; }

/* æ–‡å­—é€²å‡ºå ´å‹•ç•«ï¼ˆè¼•å¾®ï¼‰ */
.promo-rotator .pr-msg{ display:inline-block; animation:pr-fade 2.1s ease-in-out both; }
@keyframes pr-fade{
  0%{opacity:0; transform:translateY(6px);}
  10%{opacity:1; transform:translateY(0);}
  90%{opacity:1;}
  100%{opacity:0; transform:translateY(-6px);}
}

/* æ‰‹æ©Ÿï¼šæ›´å°ã€æ›´è²¼è¿‘æ¨™é¡Œï¼›é¸å–®å¤šåŠéš±è—ä¸å½±éŸ¿ */
@media (max-width: 900px){
  .promo-rotator{ font-size:13px; max-width:60vw; }
}
@media (max-width: 480px){
  .promo-rotator{ font-size:12.5px; padding:.22rem .52rem; }
}

/* æ¸›å°‘å‹•æ…‹åå¥½ï¼šé—œé–‰å‹•ç•«ä½†ä»é¡¯ç¤ºä¸€æ¬¡ */
@media (prefers-reduced-motion: reduce){
  .promo-rotator .pr-msg{ animation:none !important; }
}
/* è®“ CTA æ–‡å­—åªæ·¡å…¥ä¸¦ç¶­æŒé¡¯ç¤ºï¼ˆè¦†è“‹èˆŠçš„ pr-fadeï¼‰ */
.promo-rotator .pr-msg{
  animation: none !important;  /* å–æ¶ˆèˆŠçš„ 2.1s æ·¡å‡ºå‹•ç•« */
  opacity: 1;
  transform: none;
}
.promo-rotator.on .pr-msg{
  animation: pr-fade-in .3s ease-out both !important; /* åªåšæ·¡å…¥ */
}

@keyframes pr-fade-in{
  from{ opacity:0; transform: translateY(6px); }
  to  { opacity:1; transform: translateY(0); }
}
/* è®“æ•´æ’æ°¸é åŒä¸€è¡Œ */
nav{ flex-wrap: nowrap; }

/* æ¨™é¡Œä¸æ›è¡Œã€å¯ç¸®ã€è¶…å‡ºçœç•¥è™Ÿ */
.logo{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1 1 auto;   /* åƒå¯ç”¨ç©ºé–“ */
  min-width: 0;     /* å…è¨±åœ¨ flex å…§ç¸®å°ï¼Œçœç•¥è™Ÿæ‰æœƒç”Ÿæ•ˆ */
}

/* è¨‚é–±è† å›Šå¯ç¸®ï¼Œä¸æŠŠæ¨™é¡Œæ“ æ›è¡Œ */
.promo-rotator{
  flex: 0 1 auto;
  min-width: 0;
  text-overflow: ellipsis;
}

/* é˜² iOS Safari è‡ªå‹•æ”¾å¤§å°è‡´æ›è¡Œ */
html{ -webkit-text-size-adjust: 100%; }

/* è¶…å°è¢å¹•å†æŠŠæ¨™é¡Œå­—ç¨æ”¶ä¸€é»ï¼ˆè¦†å¯«ä½ åŸæœ¬ 20pxï¼‰ */
@media (max-width: 480px){
  .logo{ font-size: 18px; }
}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <nav>
        <button class="hamburger" id="btn-hamburger" aria-label="é–‹å•Ÿé¸å–®" aria-expanded="false" aria-controls="drawer">
          <!-- 3-line icon -->
          <svg aria-hidden="true" viewBox="0 0 24 24" fill="currentColor">
            <path d="M4 6h16v2H4zM4 11h16v2H4zM4 16h16v2H4z"/>
          </svg>
        </button>
        <div class="logo">æ—…è¡Œåœ°åœ–æ™‚å…‰æ©Ÿ</div>

        <!-- CTA è¼ªæ’­ï¼ˆlogo å¾Œã€menu å‰ï¼‰ -->
<a class="promo-rotator" id="promoRotator"
   href="https://www.youtube.com/channel/UCBO0jFbcjbi2f3mxnsEDxDg?sub_confirmation=1"
   target="_blank" rel="noopener">
  <span class="pr-icon">ğŸ””</span>
  <span class="pr-msg" aria-live="polite"></span>
</a>

        <!-- Desktop tabs -->
        <div class="menu" role="tablist" aria-label="åˆ‡æ›å…§åµŒé é¢">
          <button class="tab" id="tab-a" role="tab" aria-controls="panel-a" aria-pressed="true">Time Travel(æ™‚å…‰æ—…è¡Œ)</button>
          <button class="tab" id="tab-b" role="tab" aria-controls="panel-b" aria-pressed="false">Map Travel(åœ°åœ–æ—…è¡Œ)</button>
          <button class="tab" id="tab-c" role="tab" aria-controls="panel-c" aria-pressed="false">AI Diary æ—¥è¨˜(Beta)</button>
          <button class="tab" id="tab-d" role="tab" aria-controls="panel-d" aria-pressed="false">YourJoviå¹³å°é »é“</button>
        </div>
      </nav>
    </header>

    <!-- Backdrop + Drawer (mobile) -->
    <div class="backdrop" id="backdrop" hidden></div>
    <aside class="drawer" id="drawer" aria-label="ä¸»é¸å–®" aria-hidden="true">
      <div class="drawer-head">
        <div class="drawer-title">é¸å–®</div>
        <button class="drawer-close" id="btn-close" aria-label="é—œé–‰é¸å–®">
          <svg aria-hidden="true" viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
            <path d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.7 2.88 18.29 9.17 12 2.88 5.71 4.29 4.29 10.59 10.6 16.89 4.3z"/>
          </svg>
        </button>
      </div>
      <div class="drawer-body">
        <button class="drawer-btn" data-tab="a" aria-pressed="true">Time Travel(æ™‚å…‰æ—…è¡Œ)</button>
        <button class="drawer-btn" data-tab="b" aria-pressed="false">Map Travel(åœ°åœ–æ—…è¡Œ)</button>
        <button class="drawer-btn" data-tab="c" aria-pressed="false">AI Diary æ—¥è¨˜(Beta)</button>
        <button class="drawer-btn" data-tab="d" aria-pressed="false">YourJoviå¹³å°é »é“</button>
      </div>
    </aside>

    <main>
      <div class="frame-wrap">
        <iframe id="panel-a" title="é é¢ A" loading="lazy" allow="fullscreen; picture-in-picture"></iframe>
        <iframe id="panel-b" title="é é¢ B" class="hidden" loading="lazy" allow="fullscreen; picture-in-picture"></iframe>
        <iframe id="panel-c" title="é é¢ C" class="hidden" loading="lazy" allow="fullscreen; picture-in-picture"></iframe>
        <iframe id="panel-d" title="é é¢ D" class="hidden" loading="lazy" allow="fullscreen; picture-in-picture"></iframe>
      </div>
    </main>
  </div>

  <script>
    /* ===== Your pages mapping ===== */
    const bas_url = "https://script.google.com/macros/s/AKfycbznnuzv1qB6Sk6hSu6aM8etG0KAYZyUKxRZzXjHRPwryNpRHryHyyOhOxKvMzxc8bCn/exec";
    const PAGES = {
      a: bas_url,
      b: bas_url + "?view=map",
      c: bas_url + "?view=diary",      
      d: bas_url + "?view=help"
    };

    /* ===== Tab elements ===== */
    const tabs = {
      a: document.getElementById('tab-a'),
      b: document.getElementById('tab-b'),
      c: document.getElementById('tab-c'),
      d: document.getElementById('tab-d')
    };
    const frames = {
      a: document.getElementById('panel-a'),
      b: document.getElementById('panel-b'),
      c: document.getElementById('panel-c'),
      d: document.getElementById('panel-d')
    };

    /* ===== Drawer elements (mobile) ===== */
    const body = document.body;
    const backdrop = document.getElementById('backdrop');
    const drawer = document.getElementById('drawer');
    const btnHamburger = document.getElementById('btn-hamburger');
    const btnClose = document.getElementById('btn-close');
    const drawerBtns = Array.from(document.querySelectorAll('.drawer-btn'));

    function ensureSrc(which){
  if (PAGES[which] && !frames[which].src) {
    const url = new URL(location.href);
    // ä¿ç•™é™¤äº† view ä»¥å¤–çš„æ‰€æœ‰åƒæ•¸
    url.searchParams.delete('view');
    const extra = url.searchParams.toString();
    frames[which].src = PAGES[which] + (extra ? '&' + extra : '');
  }
}


    function show(which){
      for(const k of Object.keys(tabs)){
        tabs[k]?.setAttribute('aria-pressed', k===which);
        const pressed = (k===which);
        const dbtn = drawerBtns.find(b=>b.dataset.tab===k);
        if (dbtn) dbtn.setAttribute('aria-pressed', pressed);
        frames[k].classList.toggle('hidden', !pressed);
      }
      ensureSrc(which);
      history.replaceState(null, '', location.pathname);
      localStorage.setItem('multiSwitcher:view', which);
    }

    /* ===== Drawer open/close helpers ===== */
    function openDrawer(){
      body.classList.add('open-drawer');
      drawer.setAttribute('aria-hidden', 'false');
      btnHamburger.setAttribute('aria-expanded', 'true');
      backdrop.hidden = false;
      // focus first button for accessibility
      setTimeout(()=> drawerBtns[0]?.focus(), 0);
    }
    function closeDrawer(){
      body.classList.remove('open-drawer');
      drawer.setAttribute('aria-hidden', 'true');
      btnHamburger.setAttribute('aria-expanded', 'false');
      backdrop.hidden = true;
      btnHamburger.focus();
    }

    // Toggle via hamburger / close button / backdrop
    btnHamburger.addEventListener('click', () => {
      const expanded = btnHamburger.getAttribute('aria-expanded') === 'true';
      expanded ? closeDrawer() : openDrawer();
    });
    btnClose.addEventListener('click', closeDrawer);
    backdrop.addEventListener('click', closeDrawer);

    // ESC to close
    window.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape' && body.classList.contains('open-drawer')) closeDrawer();
    });

    // Clicking drawer items: switch tab + close drawer
    drawerBtns.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const which = btn.dataset.tab;
        show(which);
        closeDrawer();
      });
    });

    // Desktop tab clicks
    for(const k of Object.keys(tabs)){
      tabs[k].addEventListener('click', ()=> show(k));
    }

    // Init year and initial tab
const url = new URL(location.href);
const qView = (url.searchParams.get('view')||'').toLowerCase();
const mapDay = url.searchParams.get('map_day');
const mapAction = url.searchParams.get('map_action');

const saved = localStorage.getItem('multiSwitcher:view');
let initial = (['a','b','c','d'].includes(qView)) ? qView
            : (['a','b','c','d'].includes(saved) ? saved : 'a');

// è‹¥å¸¶äº† map_day è¦ç›´æ¥æ‰“é–‹åœ°åœ–é 
if (mapDay && mapAction === 'play') initial = 'b';

show(initial);


if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    const scope = '/'; // è‹¥ repo å­è·¯å¾‘ï¼Œæ”¹æˆ '/my-repo/'
    navigator.serviceWorker.register('/sw.js', { scope }).catch(console.error);
  });
}

(function(){
  const el   = document.getElementById('promoRotator');
  if(!el) return;
  const span = el.querySelector('.pr-msg');

  // è¦è¼ªæ’­çš„è¨Šæ¯ï¼ˆå¯å¢æ¸›ï¼‰
  const MSGS = [
  'å…ˆè¨‚å…ˆè´',
  'æ–°å½±ç‰‡é€šçŸ¥',
  'è¨‚é–±è§£é–',
  'é¦–æ’­ä¸ç¼ºå¸­',
  'æ¶å…ˆçœ‹æ—…ç¨‹',
  'è·Ÿä¸Šæ¯æ—¥ Vlog',
  '1åˆ†é˜çœ‹ä¸–ç•Œ',
  'AIæ—¥è¨˜å·²ä¸Šç·š',
  'ä»£è¡¨ç…§å‡ºçˆ',
  'åœ°åœ–æ–°åœ°æ¨™',
  'æ™‚é–“è»¸é€£æ’­',
  'æ—…éŠæ”»ç•¥æ›´æ–°',
  'èˆªç·šåœ–æ›´æ–°',
  'è¿½è¹¤æˆ‘å€‘',
  'æŒ‰è®šï¼‹åˆ†äº«',
  'ä¸‹ä¸€ç«™å»å“ªï¼Ÿ'
];



  // ===== å¯èª¿åƒæ•¸ =====
  const FIRST_SHOW_DELAY_MS = 2000;         // é€²ç«™å¤šä¹…å¾Œç¬¬ä¸€æ¬¡é¡¯ç¤º
  const DWELL_MS            = 60_000;       // æ¯æ¬¡é¡¯ç¤ºåœç•™æ™‚é–“ï¼ˆç´„ 1 åˆ†é˜ï¼‰
  const GAP_MIN_MS          = 5*60_000;     // ä¸‹ä¸€æ¬¡é¡¯ç¤ºçš„æœ€çŸ­é–“éš”ï¼ˆ5 åˆ†é˜ï¼‰
  const GAP_MAX_MS          = 15*60_000;    // ä¸‹ä¸€æ¬¡é¡¯ç¤ºçš„æœ€é•·é–“éš”ï¼ˆ15 åˆ†é˜ï¼‰
  // =====================

  let lastIdx = -1;
  let tShow = 0, tHide = 0;

  function randBetween(min, max){
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }
  function pickNextIndex(){
    if (MSGS.length === 1) return 0;
    let idx;
    do { idx = Math.floor(Math.random() * MSGS.length); } while (idx === lastIdx);
    lastIdx = idx;
    return idx;
  }
  function setMsg(text){
    // é‡æ–°è§¸ç™¼ CSS çš„æ·¡å…¥/æ·¡å‡ºå‹•ç•«
    span.textContent = text;
    span.style.animation = 'none'; void span.offsetWidth; span.style.animation = null;
  }

  function showOnce(){
    clearTimeout(tShow); clearTimeout(tHide);
    setMsg(MSGS[pickNextIndex()]);
    el.classList.add('on');
    tHide = setTimeout(hide, DWELL_MS);
  }
  function hide(){
    el.classList.remove('on');
    scheduleNext();
  }
  function scheduleNext(){
    const gap = randBetween(GAP_MIN_MS, GAP_MAX_MS);
    tShow = setTimeout(() => {
      // è‹¥ä½¿ç”¨è€…åˆ‡åˆ°èƒŒæ™¯é ï¼Œå†ç·©ä¸€ç·©ï¼ˆé¿å…ä»–ä¸åœ¨æ™‚å½ˆå‡ºï¼‰
      if (document.hidden) return scheduleNext();
      showOnce();
    }, gap);
  }

  // é¦–æ¬¡é¡¯ç¤º
  setTimeout(() => {
    if (!document.hidden) showOnce();
    else scheduleNext();
  }, FIRST_SHOW_DELAY_MS);

  // ä½¿ç”¨è€…è¿”å›æ­¤åˆ†é æ™‚ï¼Œå¦‚æ­£å¥½æ²’æœ‰é¡¯ç¤ºä¹Ÿæ²’æœ‰æ’ç¨‹ï¼Œå°±æ’ä¸€å€‹çŸ­å»¶é²
  document.addEventListener('visibilitychange', () => {
    if (!document.hidden && !el.classList.contains('on') && !tShow){
      tShow = setTimeout(showOnce, 5000);
    }
  });
})();

    // åœ¨å®šç¾© frames å¾Œé¢åŠ ä¸Šé€™æ®µï¼ˆframes.b å·²å­˜åœ¨ï¼‰
frames.b.addEventListener('load', () => {
  // è‹¥ç¶²å€å¸¶äº† map_day=YYYY-MM-DD&map_action=playï¼Œå°±é€šçŸ¥å­é æ’­æ”¾
  if (mapDay && mapAction === 'play') {
    try {
      frames.b.contentWindow.postMessage({ type:'playDay', day: mapDay }, 'https://www.yourjovi.com'); 
      // è‹¥åœ°åœ–é æ˜¯è·‘åœ¨ GAS ç¶²åŸŸï¼Œé€™è£¡å¯æ”¹æˆ '*'
    } catch(_) {}
  }
});

</script>
</body>
</html>
